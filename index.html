<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
        
    <title>MOH</title>

    </head>
    <body>
    <h2 class="display-2 text-center">MOH</h2>
    <hr class="dropdown-divider">
    <div>
    <form name="submit-to-google-sheet">

    <label for="Name" class="form-label">Name</label><br>
  <input name="Name" type="text" placeholder="Name" class="form-control" autocomplete="off" autofocus required><br><br>

  <label for="query">Query:</label><br>
  <select name="Query" class="form-select form-select-sm" aria-label=".form-select-sm example">
    <option value="General">Gender Based Violence</option>
    <option value="Prank Call">Sexual Gender Based Violence</option>
    <option value="Course Enquiry" id="course">Gender Based Violence</option>
    <option value="Complaint/Compliment">Complaint/Compliment</option>
    <option value="General Inquiries">General Inquiries</option>
  </select><br><br>  
    
  <br><br>

  <div class="form-floating">
  <textarea name="Description" rows="6" cols="50" class="form-control mb-3" style="height: 100px"></textarea>
  <label for="description">Description</label>
  </div>

  <label for="query">Disposition:</label><br>
  <select name="Disposition" class="form-select form-select-sm" aria-label=".form-select-sm example">
    <option value="CallBack">CallBack</option>
    <option value="Information Request">Information Request</option>
    <option value="Escalated">Escalated</option>
    <option value="Not Resolved">Not Resolved</option>
    <option value="Resolved">Resolved</option>
  </select><br><br>

  <button class="btn btn-primary" type="submit">Send</button>
</form>
<span id="msg"></span>
</div>


<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbwau3mfY4O4hstA8K_uR_H9SzgSstGq0T-1kt5dos0XwlU36wAS_2iTRbEUjE-G8ply/exec'
const form = document.forms['submit-to-google-sheet']
const msg = document.getElementById("msg")
  
    form.addEventListener('submit', e => {
      e.preventDefault()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => {
            msg.innerHTML = "Message Sent successfully"
            setTimeout(function(){
                msg.innerHTML = ""
            }, 500)
            form.reset()
        }) 
        .catch(error => console.error('Error!', error.message))
    });

</script>
    </body>
</html>

